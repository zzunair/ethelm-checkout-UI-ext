'use strict';

var respondToInvalidSessionToken = require('./respond-to-invalid-session-token.js');

async function validateSessionToken(params, request, token, { checkAudience = true } = {}) {
    const { api, logger } = params;
    logger.debug('Validating session token');
    try {
        const payload = await api.session.decodeSessionToken(token, {
            checkAudience,
        });
        logger.debug('Session token is valid', {
            payload: JSON.stringify(payload),
        });
        return payload;
    }
    catch (error) {
        logger.debug(`Failed to validate session token: ${error.message}`);
        throw respondToInvalidSessionToken.respondToInvalidSessionToken({ params, request, retryRequest: true });
    }
}

exports.validateSessionToken = validateSessionToken;
//# sourceMappingURL=validate-session-token.js.map
