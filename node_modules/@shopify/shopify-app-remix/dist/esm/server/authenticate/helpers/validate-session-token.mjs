import { respondToInvalidSessionToken } from './respond-to-invalid-session-token.mjs';

async function validateSessionToken(params, request, token, { checkAudience = true } = {}) {
    const { api, logger } = params;
    logger.debug('Validating session token');
    try {
        const payload = await api.session.decodeSessionToken(token, {
            checkAudience,
        });
        logger.debug('Session token is valid', {
            payload: JSON.stringify(payload),
        });
        return payload;
    }
    catch (error) {
        logger.debug(`Failed to validate session token: ${error.message}`);
        throw respondToInvalidSessionToken({ params, request, retryRequest: true });
    }
}

export { validateSessionToken };
//# sourceMappingURL=validate-session-token.mjs.map
